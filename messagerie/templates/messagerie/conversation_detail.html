{% extends 'base.html' %}
{% block content %}
<h2>Conversation avec {{ conversation.get_other_participant:user }}</h2>

<div class="messages">
  {% for message in messages %}
    <div>
      <strong>{{ message.sender.username }}</strong> : {{ message.content }}
      <small>{{ message.timestamp }}</small>
      <div>
        Réactions :
        {% for reaction in message.reactions.all %}
          {{ reaction.reaction_type }} ({{ reaction.user.username }})
        {% endfor %}
      </div>

      <!-- Formulaire de réaction -->
      <form method="post" action="{% url 'messaging:react_to_message' message.id %}">
        {% csrf_token %}
        <input type="text" name="reaction_type" placeholder="👍, ❤️, 😂...">
        <button type="submit">Réagir</button>
      </form>
    </div>
  {% endfor %}
</div>

<!-- Formulaire d’envoi de message -->
<form method="post">
  {% csrf_token %}
  {{ message_form.as_p }}
  <button type="submit">Envoyer</button>
</form>
{% endblock %}
